<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xmlns:tx="http://www.springframework.org/schema/tx"
		
		xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
							http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
							"
		default-lazy-init="true">
	
	<bean id="finalSessionFactory" parent="sessionFactory">
		<property name="mappingResources">
        	<list>
            	<value>resources/Specimen.hbm.xml</value>
            	<value>resources/Image.hbm.xml</value>
            	<value>resources/Tiledimage.hbm.xml</value>
            	<value>resources/Activitystatus.hbm.xml</value>
            	<value>resources/Dataset.hbm.xml</value>
            	<value>resources/Experiment.hbm.xml</value>
            	<value>resources/Experimentalstudy.hbm.xml</value>
            	<value>resources/Experimenter.hbm.xml</value>
            	<value>resources/Experimentergroup.hbm.xml</value>
            	<value>resources/Instrument.hbm.xml</value>
            	<value>resources/Location.hbm.xml</value>
            	<value>resources/Patient.hbm.xml</value>
            	<value>resources/Project.hbm.xml</value>
            	<value>resources/Server.hbm.xml</value>
            	<value>resources/Tileset.hbm.xml</value>
        	</list>
    	</property>
	</bean>
	
	<tx:annotation-driven transaction-manager="transactionManager"/>
	
	<bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
		<property name="sessionFactory">
			<ref bean="finalSessionFactory"/>
		</property>
	</bean>
	<bean class="org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor"/>
	
	<bean id="imageDAO" class="edu.emory.cci.imagedb.hibernatedao.ImageDAOImplementation">
		<property name="sessionFactory" ref="finalSessionFactory"/>
	</bean>
	
	<bean id="imagesQueue" class="java.util.concurrent.LinkedBlockingQueue" />
	
	<bean id="imageProducer" class="edu.emory.cci.imagedb.DataLoader.ImageProducer">
		<property name="dataLoader" ref="imageDBDataLoader"/>
		<property name="imageDAO" ref="imageDAO"/>
	</bean>
	<bean id="imageConsumer" class="edu.emory.cci.imagedb.DataLoader.ImageConsumer">
		<property name="dataLoader" ref="imageDBDataLoader"/>
		<property name="imageDAO" ref="imageDAO"/>
	</bean>
	
	<bean id="imageDBDataLoader" class="edu.emory.cci.imagedb.DataLoader.ImageDBDataLoader">
		<property name="imagesQueue" ref="imagesQueue" />
	</bean>
	
</beans>